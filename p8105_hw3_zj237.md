p8105_hw3_zj2357
================
Zekai Jin (zj2357)
2022-10-10

First of all, we should include the libraries we are using.

``` r
library(tidyverse)
library(p8105.datasets)
```

# Problem 1

``` r
data("instacart")
aisle_group = 
  instacart %>%
  group_by(aisle) %>%
  summarise(n_obs =  n()) %>%
  arrange(-n_obs)
```

Thus, there are 134 different aisles. The most popular aisle is fresh
vegetables. Then, we make a plot of aisles with more than 10000 items
ordered.

``` r
aisle_group %>%
  mutate(aisle=fct_reorder(aisle,-n_obs)) %>%
  filter(n_obs > 10000) %>%
  ggplot(aes(x = n_obs,y = aisle,fill=n_obs)) +
  geom_col(orientation="y") +
  xlab("items_saled") +
  viridis::scale_fill_viridis(trans = "log",
                              name = "Items saled",
                              breaks = c(25000,50000,100000)) 
```

![](p8105_hw3_zj237_files/figure-gfm/unnamed-chunk-2-1.png)<!-- --> The
three most popular items in these isles are

``` r
instacart %>%
  filter(aisle == "baking ingredients" |
         aisle == "dog food care" |
         aisle == "packaged vegetables fruits") %>%
  group_by(aisle, product_name) %>%
  summarise(
    n_obs=n()
  ) %>%
  arrange(aisle,-n_obs) %>%
  summarise(
    popular_item = head(product_name,3),
    n = head(n_obs,3),
    rank = head(rank(-n_obs),3)
  )
```

    ## # A tibble: 9 × 4
    ## # Groups:   aisle [3]
    ##   aisle                      popular_item                                n  rank
    ##   <chr>                      <chr>                                   <int> <dbl>
    ## 1 baking ingredients         Light Brown Sugar                         499     1
    ## 2 baking ingredients         Pure Baking Soda                          387     2
    ## 3 baking ingredients         Cane Sugar                                336     3
    ## 4 dog food care              Snack Sticks Chicken & Rice Recipe Dog…    30     1
    ## 5 dog food care              Organix Chicken & Brown Rice Recipe        28     2
    ## 6 dog food care              Small Dog Biscuits                         26     3
    ## 7 packaged vegetables fruits Organic Baby Spinach                     9784     1
    ## 8 packaged vegetables fruits Organic Raspberries                      5546     2
    ## 9 packaged vegetables fruits Organic Blueberries                      4966     3

``` r
instacart %>%
  filter(product_name == "Pink Lady Apples" |
         product_name == "Coffee Ice Cream"
         ) %>%
  group_by(product_name,order_dow) %>%
  summarise(
    mean_hour = mean(order_hour_of_day)
  ) %>%
  pivot_wider(names_from = "order_dow",
              values_from = "mean_hour",
              names_prefix = "day ")
```

    ## # A tibble: 2 × 8
    ## # Groups:   product_name [2]
    ##   product_name     `day 0` `day 1` `day 2` `day 3` `day 4` `day 5` `day 6`
    ##   <chr>              <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ## 1 Coffee Ice Cream    13.8    14.3    15.4    15.3    15.2    12.3    13.8
    ## 2 Pink Lady Apples    13.4    11.4    11.7    14.2    11.6    12.8    11.9
